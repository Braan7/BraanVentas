{% extends 'base.html' %}{% block content %}<h3>Carrito</h3>{% if cart|length == 0 %}<p>No hay productos.</p>{% else %}<table class='table table-dark'><thead><tr><th>Producto</th><th>Cant</th><th>Precio</th><th>Subtotal</th></tr></thead><tbody>{% for i in cart %}<tr><td>{{ i.name }}</td><td>{{ i.qty }}</td><td>${{ '%.2f'|format(i.price) }}</td><td>${{ '%.2f'|format(i.price*i.qty) }}</td></tr>{% endfor %}</tbody></table><p class='h5'>Total: ${{ '%.2f'|format(total) }}</p><hr><form id='checkoutForm' method='post' action='/checkout' onsubmit='return goPay(event)'><div class='row g-2'><div class='col-md-4'><label>ID de jugador (Free Fire)</label><input class='form-control' name='ff_id' required></div><div class='col-md-4'><label>Nombre del jugador</label><input class='form-control' name='ff_name' required></div><div class='col-md-4'><label>MÃ©todo de pago</label><select class='form-select' name='metodo'><option value='saldo'>Saldo</option><option value='binance'>Binance</option></select></div></div><div class='mt-3 d-flex gap-2'><button class='btn btn-success'>Proceder a pagar</button><button type='button' class='btn btn-outline-warning' onclick='vaciar()'>Vaciar carrito</button></div></form><script>async function vaciar(){await fetch('/cart/clear',{method:'POST'});location.reload();}async function goPay(e){e.preventDefault();const res=await fetch('/checkout',{method:'POST', body:new FormData(document.getElementById('checkoutForm'))});const data=await res.json();if(data.ok){ location.href=data.redirect;} else { alert(data.msg||'Error'); }}</script>{% endif %}{% endblock %}